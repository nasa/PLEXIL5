mod TEST--EVALUATION is

  pr TEST-BASE .

  op test--evaluation : -> TestResults .
  eq test--evaluation =
    begin tests

    assert "eval of arrayVar" from
      anExpression(
        eval(
            mtenvironment,
            [ < 'src . 'array8 : memory |
                    initVal: array(val(5.0) # val(6.0)),
                    actVal: array(val(5.0) # val(6.0)),
                    prevVal: array(val(5.0) # val(6.0)) > ],
            arrayVar('src . 'array8)
        )
      )
    reaches
      anExpression(
        const(array(val(5.0) # val(6.0)))
      )
    end

    end tests
    .

endm